-----BEGIN CERTIFICATE-----
IiIiUkFHIHJldHJpZXZhbCBhbmQgc3ludGhlc2lzIGxvZ2ljLiIiIgppbXBvcnQg
anNvbgppbXBvcnQgcGlja2xlCmZyb20gcGF0aGxpYiBpbXBvcnQgUGF0aApmcm9t
IHNrbGVhcm4ubWV0cmljcy5wYWlyd2lzZSBpbXBvcnQgY29zaW5lX3NpbWlsYXJp
dHkKaW1wb3J0IG51bXB5IGFzIG5wCgpmcm9tIC5zY2hlbWFzIGltcG9ydCBDaXRh
dGlvbiwgQXNrUmVzcG9uc2UKCklOREVYX0RJUiA9IFBhdGgoX19maWxlX18pLnBh
cmVudC5wYXJlbnQgLyAiaW5kZXgiCkNPTkZJREVOQ0VfVEhSRVNIT0xEID0gMC4x
NQpUT1BfSyA9IDMKCmNsYXNzIFJBR0VuZ2luZToKICAgIGRlZiBfX2luaXRfXyhz
ZWxmKToKICAgICAgICBzZWxmLnZlY3Rvcml6ZXIgPSBOb25lCiAgICAgICAgc2Vs
Zi50ZmlkZl9tYXRyaXggPSBOb25lCiAgICAgICAgc2VsZi5kb2N1bWVudHMgPSBO
b25lCiAgICAgICAgc2VsZi5fbG9hZF9pbmRleCgpCiAgICAKICAgIGRlZiBfbG9h
ZF9pbmRleChzZWxmKToKICAgICAgICB2ZWN0b3JpemVyX3BhdGggPSBJTkRFWF9E
SVIgLyAidmVjdG9yaXplci5wa2wiCiAgICAgICAgbWF0cml4X3BhdGggPSBJTkRF
WF9ESVIgLyAidGZpZGZfbWF0cml4LnBrbCIKICAgICAgICBkb2NzX3BhdGggPSBJ
TkRFWF9ESVIgLyAiZG9jdW1lbnRzLmpzb24iCiAgICAgICAgCiAgICAgICAgaWYg
bm90IGFsbChwLmV4aXN0cygpIGZvciBwIGluIFt2ZWN0b3JpemVyX3BhdGgsIG1h
dHJpeF9wYXRoLCBkb2NzX3BhdGhdKToKICAgICAgICAgICAgcmFpc2UgRmlsZU5v
dEZvdW5kRXJyb3IoIkluZGV4IG5vdCBmb3VuZC4gUnVuIGluZ2VzdGlvbiBmaXJz
dC4iKQogICAgICAgIAogICAgICAgIHdpdGggb3Blbih2ZWN0b3JpemVyX3BhdGgs
ICJyYiIpIGFzIGY6CiAgICAgICAgICAgIHNlbGYudmVjdG9yaXplciA9IHBpY2ts
ZS5sb2FkKGYpCiAgICAgICAgd2l0aCBvcGVuKG1hdHJpeF9wYXRoLCAicmIiKSBh
cyBmOgogICAgICAgICAgICBzZWxmLnRmaWRmX21hdHJpeCA9IHBpY2tsZS5sb2Fk
KGYpCiAgICAgICAgd2l0aCBvcGVuKGRvY3NfcGF0aCwgInIiKSBhcyBmOgogICAg
ICAgICAgICBzZWxmLmRvY3VtZW50cyA9IGpzb24ubG9hZChmKQogICAgCiAgICBk
ZWYgcmV0cmlldmUoc2VsZiwgcXVlcnksIHRvcF9rPVRPUF9LKToKICAgICAgICBx
dWVyeV92ZWMgPSBzZWxmLnZlY3Rvcml6ZXIudHJhbnNmb3JtKFtxdWVyeV0pCiAg
ICAgICAgc2ltaWxhcml0aWVzID0gY29zaW5lX3NpbWlsYXJpdHkocXVlcnlfdmVj
LCBzZWxmLnRmaWRmX21hdHJpeCkuZmxhdHRlbigpCiAgICAgICAgdG9wX2luZGlj
ZXMgPSBucC5hcmdzb3J0KHNpbWlsYXJpdGllcylbLXRvcF9rOl1bOjotMV0KICAg
ICAgICAKICAgICAgICByZXN1bHRzID0gW10KICAgICAgICBmb3IgaWR4IGluIHRv
cF9pbmRpY2VzOgogICAgICAgICAgICBzY29yZSA9IGZsb2F0KHNpbWlsYXJpdGll
c1tpZHhdKQogICAgICAgICAgICBpZiBzY29yZSA+IDA6CiAgICAgICAgICAgICAg
ICByZXN1bHRzLmFwcGVuZCgoc2VsZi5kb2N1bWVudHNbaWR4XSwgc2NvcmUpKQog
ICAgICAgIHJldHVybiByZXN1bHRzCiAgICAKICAgIGRlZiBzeW50aGVzaXplKHNl
bGYsIHF1ZXJ5KToKICAgICAgICByZXN1bHRzID0gc2VsZi5yZXRyaWV2ZShxdWVy
eSkKICAgICAgICAKICAgICAgICBpZiBub3QgcmVzdWx0czoKICAgICAgICAgICAg
cmV0dXJuIEFza1Jlc3BvbnNlKAogICAgICAgICAgICAgICAgYW5zd2VyPSIiLAog
ICAgICAgICAgICAgICAgY29uZmlkZW5jZT0wLjAsCiAgICAgICAgICAgICAgICBj
aXRhdGlvbnM9W10sCiAgICAgICAgICAgICAgICBhYnN0YWluZWQ9VHJ1ZSwKICAg
ICAgICAgICAgICAgIG1lc3NhZ2U9Ik5vIHJlbGV2YW50IGluZm9ybWF0aW9uIGZv
dW5kLiIKICAgICAgICAgICAgKQogICAgICAgIAogICAgICAgIHRvcF9zY29yZSA9
IHJlc3VsdHNbMF1bMV0KICAgICAgICBjb25maWRlbmNlID0gbWluKHRvcF9zY29y
ZSAqIDIsIDEuMCkKICAgICAgICAKICAgICAgICBpZiB0b3Bfc2NvcmUgPCBDT05G
SURFTkNFX1RIUkVTSE9MRDoKICAgICAgICAgICAgcmV0dXJuIEFza1Jlc3BvbnNl
KAogICAgICAgICAgICAgICAgYW5zd2VyPSIiLAogICAgICAgICAgICAgICAgY29u
ZmlkZW5jZT1jb25maWRlbmNlLAogICAgICAgICAgICAgICAgY2l0YXRpb25zPVtd
LAogICAgICAgICAgICAgICAgYWJzdGFpbmVkPVRydWUsCiAgICAgICAgICAgICAg
ICBtZXNzYWdlPWYiQ29uZmlkZW5jZSB0b28gbG93ICh7Y29uZmlkZW5jZTouMmZ9
KS4iCiAgICAgICAgICAgICkKICAgICAgICAKICAgICAgICBjaXRhdGlvbnMgPSBb
XQogICAgICAgIGZvciBkb2MsIHNjb3JlIGluIHJlc3VsdHM6CiAgICAgICAgICAg
IGNpdGF0aW9ucy5hcHBlbmQoQ2l0YXRpb24oCiAgICAgICAgICAgICAgICBjaHVu
a19pZD1kb2NbImNodW5rX2lkIl0sCiAgICAgICAgICAgICAgICB0ZXh0PWRvY1si
dGV4dCJdWzo1MDBdICsgKCIuLi4iIGlmIGxlbihkb2NbInRleHQiXSkgPiA1MDAg
ZWxzZSAiIiksCiAgICAgICAgICAgICAgICBzY29yZT1yb3VuZChzY29yZSwgNCks
CiAgICAgICAgICAgICAgICBzb3VyY2VfZmlsZT1kb2NbInNvdXJjZV9maWxlIl0K
ICAgICAgICAgICAgKSkKICAgICAgICAKICAgICAgICBjb250ZXh0X3RleHRzID0g
W2RvY1sidGV4dCJdIGZvciBkb2MsIF8gaW4gcmVzdWx0c10KICAgICAgICBhbnN3
ZXIgPSBzZWxmLl9nZW5lcmF0ZV9hbnN3ZXIocXVlcnksIGNvbnRleHRfdGV4dHMs
IGNpdGF0aW9ucykKICAgICAgICAKICAgICAgICByZXR1cm4gQXNrUmVzcG9uc2Uo
CiAgICAgICAgICAgIGFuc3dlcj1hbnN3ZXIsCiAgICAgICAgICAgIGNvbmZpZGVu
Y2U9cm91bmQoY29uZmlkZW5jZSwgNCksCiAgICAgICAgICAgIGNpdGF0aW9ucz1j
aXRhdGlvbnMsCiAgICAgICAgICAgIGFic3RhaW5lZD1GYWxzZQogICAgICAgICkK
ICAgIAogICAgZGVmIF9nZW5lcmF0ZV9hbnN3ZXIoc2VsZiwgcXVlcnksIGNvbnRl
eHRzLCBjaXRhdGlvbnMpOgogICAgICAgIGNvbWJpbmVkID0gIiAiLmpvaW4oY29u
dGV4dHMpCiAgICAgICAgc2VudGVuY2VzID0gY29tYmluZWQucmVwbGFjZSgiXG4i
LCAiICIpLnNwbGl0KCIuIikKICAgICAgICAKICAgICAgICBxdWVyeV90ZXJtcyA9
IHNldChxdWVyeS5sb3dlcigpLnNwbGl0KCkpCiAgICAgICAgcmVsZXZhbnRfc2Vu
dGVuY2VzID0gW10KICAgICAgICAKICAgICAgICBmb3Igc2VudCBpbiBzZW50ZW5j
ZXM6CiAgICAgICAgICAgIHNlbnQgPSBzZW50LnN0cmlwKCkKICAgICAgICAgICAg
aWYgbGVuKHNlbnQpIDwgMjA6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAg
ICAgICAgICBzZW50X3Rlcm1zID0gc2V0KHNlbnQubG93ZXIoKS5zcGxpdCgpKQog
ICAgICAgICAgICBvdmVybGFwID0gbGVuKHF1ZXJ5X3Rlcm1zICYgc2VudF90ZXJt
cykKICAgICAgICAgICAgaWYgb3ZlcmxhcCA+IDA6CiAgICAgICAgICAgICAgICBy
ZWxldmFudF9zZW50ZW5jZXMuYXBwZW5kKChzZW50LCBvdmVybGFwKSkKICAgICAg
ICAKICAgICAgICByZWxldmFudF9zZW50ZW5jZXMuc29ydChrZXk9bGFtYmRhIHg6
IHhbMV0sIHJldmVyc2U9VHJ1ZSkKICAgICAgICB0b3Bfc2VudGVuY2VzID0gW3Nb
MF0gZm9yIHMgaW4gcmVsZXZhbnRfc2VudGVuY2VzWzozXV0KICAgICAgICAKICAg
ICAgICBpZiB0b3Bfc2VudGVuY2VzOgogICAgICAgICAgICBhbnN3ZXIgPSAiLiAi
LmpvaW4odG9wX3NlbnRlbmNlcykgKyAiLiIKICAgICAgICAgICAgc291cmNlcyA9
IGxpc3Qoc2V0KGMuc291cmNlX2ZpbGUgZm9yIGMgaW4gY2l0YXRpb25zKSkKICAg
ICAgICAgICAgYW5zd2VyICs9IGYiIFtTb3VyY2VzOiB7JywgJy5qb2luKHNvdXJj
ZXMpfV0iCiAgICAgICAgICAgIHJldHVybiBhbnN3ZXIKICAgICAgICAKICAgICAg
ICByZXR1cm4gZiJCYXNlZCBvbiB0aGUgZmlsaW5nOiB7Y29udGV4dHNbMF1bOjMw
MF19Li4uIgoKX2VuZ2luZSA9IE5vbmUKCmRlZiBnZXRfZW5naW5lKCk6CiAgICBn
bG9iYWwgX2VuZ2luZQogICAgaWYgX2VuZ2luZSBpcyBOb25lOgogICAgICAgIF9l
bmdpbmUgPSBSQUdFbmdpbmUoKQogICAgcmV0dXJuIF9lbmdpbmUK
-----END CERTIFICATE-----
